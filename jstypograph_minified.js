/*!
 * JS Typograph
 * The Javascript Typography Correcter
 *
 * @version   3.0.0
 * @author    «BufferOverflow»
 * @copyright Данил Ерошенко «BufferOverflow» <buffer.overflow.x86 at gmail dot com>
 * @link      https://github.com/BufferOverflowx86/JSTypography3
 * @license   MIT; https://opensource.org/licenses/MIT
 */
(function(){if(!Array.indexOf){Array.prototype.indexOf=function(h){for(var g=0;g<this.length;g++){if(this[g]==h){return g}}return -1}}if(!String.r){String.prototype.r=String.prototype.replace}var d=function(h,g){return new RegExp(h,g)};var f={protectStack:[],defaultConfig:{mode:"text",br:false,chars:true,tabs:true,quotes:true,quotesLevel:2,lang:"rus",href:true,functions:true,spaces:true,dashs:true,h1:true,nbsp:true,clearUntypo:false,nbsptabs:false},fixConfig:function(g){return Object.assign(this.defaultConfig,g)},protect:function(g,j){s=j.match(d("<untypoX?>[\\s\\S]+?</untypoX?>","g"));var h=0;if(s){for(;h<s.length;h++){j=j.r(s[h],"✁UNTYPO"+this.protectStack.length+"S✃");this.protectStack.push(s[h])}}return j},unprotect:function(g,j){while(this.protectStack.length>0){var i=this.protectStack.pop().r(d("<\\/?untypoX>","g"),"");var h;if(g.clearUntypo){h=i.r(d("<\\/?untypo>","g"),"")}else{h=i}j=j.r("✁UNTYPO"+this.protectStack.length+"S✃",h)}return j},typographySelection:function(k,m){typobegin=true;typoend=true;var g="",l;var n=m.scrollTop;if(m&&m.value&&m.selectionStart!=undefined){var j=m.selectionStart;var i=m.selectionEnd;g=m.value.substring(j,i);if(g==""){m.value=this.typographyText(k,m.value,typobegin,typoend)}else{if(j!=0){if(m.value.charAt(j-1)!="\n"&&m.value.charAt(j-1)!="\r"){typobegin=false}}if(i!=m.value.length){if(m.value.charAt(i)!="\n"&&m.value.charAt(i)!="\r"){typoend=false}}l=this.typographyText(k,g,typobegin,typoend);m.value=m.value.substring(0,j)+l+m.value.substring(i)}}else{if(document.selection&&document.selection.createRange){var h=document.selection.createRange();g=h.text;if(g==""){m.value=this.typographyText(k,m.value,typobegin,typoend)}else{typobegin=false;typoend=false;l=this.typographyText(k,g,typobegin,typoend);h.text=l}}else{m.value=this.typographyText(k,m.value,typobegin,typoend)}}m.scrollTop=n},typographyText:function(N,B,y,t){if(y==null){y=true}if(t==null){t=true}var C,x,p=N.mode.indexOf("forum")!=-1,A=N.mode.indexOf("html")!=-1;var m=["—","«","»","…","©","®","™","←","→","↑","↓","↔","°","́","×","≠","±","↕","‘","’","−","–","“","”","„","≥","≤","§","€","£","″","√","∫","½","¼","¾"," ","‚","¹","²","³","⅓","⅔","⅕","⅖","⅗","⅘","⅙","⅚","⅛","⅜","⅝","⅞","≈",'"',"⁰","⁴","⁵","⁶","⁷","⁸","⁹","⁺","⁻","⁼","⁽","⁾","ⁿ","ⁱ","₀","₁","₂","₃","₄","₅","₆","₇","₈","₉","₊","₋","₌","₍","₎"];var L=["mdash","laquo","raquo","hellip","copy","reg","trade","larr","rarr","uarr","darr","harr","deg","#769","times","ne","plusmn","#8597","lsquo","rsquo","minus","ndash","ldquo","rdquo","bdquo","ge","le","sect","euro","pound","Prime","radic","int","frac12","frac14","frac34","nbsp","sbquo","sup1","sup2","sup3","#8531","#8532","#8533","#8534","#8535","#8536","#8537","#8538","#8539","#8540","#8541","#8542","#8776","quot","#8304","#8308","#8309","#8310","#8311","#8312","#8313","#8314","#8315","#8316","#8317","#8318","#8319","#8305","#8320","#8321","#8322","#8323","#8324","#8325","#8326","#8327","#8328","#8329","#8330","#8331","#8332","#8333","#8334"];var o=d("([  \n\t\v]|^)(((ht|f)tps?://)?([\\-\\w]+:[\\-\\w]+@)?([0-9a-z][\\-0-9a-z]*[0-9a-z]\\.)+[a-z]{2,6}(:\\d{1,5})?([?/\\\\#][?!^$.(){}:|=[\\]+\\-/\\\\*;&~#@,%\\wА-Яа-я]*)?)([  \n\t\v]|$)","gi");var r=d("([  \n\t\v]|^)([\\-a-z0-9!#$%&'*+\\/=?^_`{|}~]+(\\.[\\-a-z0-9!#$%&'*+\\/=?^_`{|}~]+)*@([a-z0-9]([\\-a-z0-9]{0,61}[a-z0-9])?.)*([a-z]{2,6}))([  \n\t\v]|$)","gi");B=B.r(/(\r\n|\r)/g,"\n");if(p){B=B.r(/(\[code[^\]$\n]*\\]|\[quote[^\]$\n]*\]|\[img\])/g,"<untypoX>$1").r(/(\[\/code\]|\[\/quote\]|\[\/img\])/g,"$1</untypoX>").r(/(\[url[^\[\]]+?\])/g,"<untypoX>$1</untypoX>")}if(A){B=B.r(/(<pre[^<>]*?>)/g,"<untypoX>$1").r(/(<\/pre>)/g,"$1</untypoX>").r(/(<script[^<>]*?>|<style[^<>]*?>)/g,"<untypoX>$1").r(/(<\/script>|<\/style>)/g,"$1</untypoX>").r(/(<!--(.|\n)*?-->)/g,"<untypoX>$1</untypoX>").r(/(="[^"\n\r]*")/g,"<untypoX>$1</untypoX>")}for(var J=0;J<10;++J){B=B.r(d("(<untypoX>)([\\s\\S]*?)(<\\/?untypoX>)","g"),function(i,g,l,j){if(j.charAt(1)!="/"){return g+l}else{return i}});B=B.r(d("(<\\/untypoX>)([\\s\\S]*?)(<\\/?untypoX>)","g"),function(i,g,l,j){if(j.charAt(1)=="/"){return l+j}else{return i}})}B=this.protect(N,B);if(A&&N.href){for(var J=0;J<2;++J){B=B.r(o,'$1<untypoX><a href="$2">$2</a></untypoX>$9');B=B.r(r,'$1<untypoX><a href="mailto:$2">$2</a></untypoX>$7')}}else{for(var J=0;J<2;++J){B=B.r(o,"$1<untypoX>$2</untypoX>$9").r(r,"$1<untypoX>$2</untypoX$7")}}B=this.protect(N,B);for(var J=0;J<L.length;++J){B=B.r(d("&"+L[J]+";","g"),m[J])}if(N.br){B=B.r(/<br( *[^\n>]*?)?\/?>/gi,"\n")}B=B.r(/<\/?p>/gi,"");B=B.r(/<\/?h1>/gi,"");B=B.r(/<\/?nbsp>/gi,"");if(N.chars){B=B.r(/\(c\)/g,"©").r(/\(r\)/g,"®").r(/\(tm\)/g,"™");if(!A){B=B.r(/&lt;/g,"<").r(/&gt;/g,">")}B=B.r(/…/g,"...")}if(N.quotes){B=B.r(/«|»|”|“|„/g,'"');if(N.lang!="eng"){B=B.r(/‚|‘/g,'"')}}if(N.functions){var D=function(w,j,R){var q="ABGDEZHJIKLMNQCOPRSTYUFXVWabgdezhjiklmnqcoprstyufxvw",Q="ΑΒΓΔΕΖΗΘΙΚΛΜΝΞΞΟΠΡΣΤΥΥΦΧΨΩαβγδεζηθικλμνξξοπρστυυφχψω";for(var P=0;P<52;++P){if(R==q.charAt(P)){return Q.charAt(P)}}return"?"};B=B.r(/(УДАР|ACNT)\(([\wА-яёЁ]?)\)/g,"$2́").r(/(СТРЛ|ARRW)\(([\wА-яёЁ]+?)\)/g,function(g,j,i){return i=="В"||i=="U"?"↑":i=="Н"||i=="D"?"↓":i=="Л"||i=="L"?"←":i=="П"||i=="R"?"→":i=="ЛП"||i=="LR"?"↔":i=="ВН"||i=="UD"?"↕":g});B=B.r(/(ГРАД|DEGR)\(([0-9\.]*)\)/g,"$2°").r(/(ПАРА|SECT)\(([IVXLСDМ0-9]*)\)/g,"§ $2").r(/(ЕВРО|EURO)\(([0-9\.]*)\)/g,"$2€").r(/(ФУНТ|PUND)\(([0-9\.]*)\)/g,"$2£").r(/(ДЮЙМ|INCH)\(([0-9\.]*)\)/g,"$2″").r(/(КОРН|SQRT)\(([\w0-9]*)\)/g,"√$2").r(/(ИНТГ|INTG)\(([\w0-9]*)\)/g,"∫$2").r(/(ГРЕЧ|GREK)\(([A-Za-z])\)/g,D);C=B.match(/(ВЕРХ|SUPS)\[([0-9+\-=\(\)ni]+)\]/g);if(C){for(var J=0;J<C.length;++J){var F="0123456789-=ni",K="⁰¹²³⁴⁵⁶⁷⁸⁹⁻⁼ⁿⁱ";var E=C[J].r(/(ВЕРХ|SUPS)\[([0-9+\-=\(\)ni]+)\]/g,"$2");for(var H=0;H<14;++H){E=E.r(d(F.charAt(H),"g"),K.charAt(H))}E=E.r(/\+/g,"⁺").r(/\(/g,"⁽").r(/\)/g,"⁾");B=B.r(C[J],E)}}C=B.match(/(НИЖН|SUBS)\[([0-9+\-=\(\)]+)\]/g);if(C){for(var J=0;J<C.length;++J){var F="0123456789-=",K="₀₁₂₃₄₅₆₇₈₉₋₌";var E=C[J].r(/(НИЖН|SUBS)\[([0-9+\-=\(\)]+)\]/g,"$2");for(var H=0;H<12;++H){E=E.r(d(F.charAt(H),"g"),K.charAt(H))}E=E.r(/\+/g,"₊").r(/\(/g,"₍").r(/\)/g,"₎");B=B.r(C[J],E)}}}if(N.spaces){if(y){B=B.r(/(^)[ \t]+/g,"$1")}B=B.r(/([\d]) ?(€|£|л\.|[скм]?м[\/\^¹²³\.\s]|г[аг]?[\s\.]|ц\.|т[\s\.]|р\.|руб\.|уе|тыс\.|млн|млрд)/g,"$1 $2").r(/([\d]) г\.[  ]?г\./g,"$1 гг.").r(/([IVXLCDM]) ?(вв?\.)/g,"$1 $2").r(/([IVXLCDM]) в\.[  ]?в\./g,"$1 вв.");B=B.r(/([^\d]|^)([\d]+(?:[\.,][\d]+)?) ?\$/g,"$1$$$2").r(/(\,|;|:|!|\?|\))([^\d\s=?!:,\.'’‘‚"«»“”\[])/gi,"$1 $2").r(/(\[color=[^\n]*\])( | )( | )( | )( | )/g,"$2$3$4$5$1").r(/ {2,}/g," ").r(/\.([^\s\dA-Za-z\n=?:;,\.'’‘"»„“”\[]+)/gi,". $1").r(/([А-яёЁ])\.([^\sA-Za-z\n=?:;,\.'’‘"»„“”\[]+)/g,"$1. $2").r(/ (\.|,|!|\?|;|:)/g,"$1").r(/(—|–|-)\.{2,4} /g,"$1 ...").r(/(\n|^|&)( *)\.{2,4} /g,"$1$2...").r(/(['‘‚"«„“\(])\.{2,4} /g,"$1...").r(/(\s|^)\.{2,4}[  ]/g,"$1...").r(/\( /g,"(").r(/ \)/g,")").r(/([^\s])\(/g,"$1 (").r(/([^\d])(,|\.)([\d])/g,"$1$2 $3").r(/(!|\?|\))([^\s=?!:,\.'’‘‚"«»“”\[]+)/gi,"$1 $2").r(/ %/g,"%").r(/P\. ?P\. ?S\./g,"P. P. S.").r(/P\. ?S\./g,"P. S.").r(/и др\./g,"и др.").r(/([\s]|^)(гл?|ул|д|илл)\. ([A-Za-zА-яёЁ0-9])/g,"$1$2. $3").r(/(\s|^)([тнсюзв])\. ?([еочнпдшдэ])\./g,"$1$2. $3.").r(/(\s|^)т\.? ?([нпдч])\./g,"$1т. $2.").r(/ н\. э\./g," н. э").r(/([№§]) ?([\dIVXLCDM])/g,"$1 $2").r(/(\d)([lpd]pi)([\s,\.!?]|$)/g,"$1 $2$3").r(/ГОСТ /gi,"ГОСТ ").r(/ГОСТ Р /gi,"ГОСТ Р ").r(/([\s]|^)до[  ]нэ\./g,"$1до н. э.");B=B.r(/ {2,}/g," ");for(var J=0;J<2;++J){B=B.r(/([  \n\t\v]|^)([иаксуов]|же|до|из|н[аое]|по|о[тб]|за|как|что|над|под|пр[ои]|или|для|без|если|едва|л?ибо|зато|пока|дабы|ежели|когда|перед|чтобы|через|пусть|будто|однако|словно) ([А-яёЁ])/gi,"$1$2 $3")}}B=B.r(/(\n|^)[  \t]+/g,"$1");if(N.tabs){if(!A){B=B.r(/(\n)([^\s])/g,"$1    $2").r(/(^|\n) +/g,"$1    ").r(/(\n|^) +\n/g,"$1\n");if(y){B=B.r(/(^)([^\s])/g,"$1    $2")}}}if(N.dashs){if(N.lang=="rus"){B=B.r(/(\s|^|<p>)([«"„‚]*)(-|–)([\s]|$)/g,"$1$2—$4");B=B.r(/([A-Za-zА-яёЁ0-9]) —/g,"$1 —");B=B.r(/([\.,!?] |\n|^|<p>)— ([A-Za-zА-яёЁ0-9«"„‚])/g,"$1— $2");var O="(где|зачем|как|какая|каки[емх]|како[ейм]|какого|какому|кем|когда|кого|кому?|кто|куда|откуда|почему|чего|чему?|что|ч[её]м)";B=B.r(d("([^А-яёЁ]|^)"+O+"(?:[  ]?|-[  ]|[  ]-)(то|либо|нибудь)([^А-яёЁ]|$)","gi"),"$1$2-$3$4").r(d("([^А-яёЁ]|^)"+O+"(?:[  ]?|-[  ]|[  ]-)(то|либо|нибудь)([^А-яёЁ]|$)","gi"),"$1$2-$3$4").r(d("([^А-яёЁ]|^)(кое|кой)(?:[  ]?[-—]?[  ]?)"+O+"([^А-яёЁ]|$)","gi"),"$1$2-$3$4").r(d("([^А-яёЁ]|^)(ко[ей])(?:[  ]?[-—]?[  ]?)"+O+"([^А-яёЁ]|$)","gi"),"$1$2-$3$4").r(/([\s]|^)(из)(?:[  ]?[-—]?[  ]?)(за)([\s]|$)/gi,"$1$2-$3$4").r(/([\s]|^)(из)(?:[  ]?[-—]?[  ]?)(под)([\s]|$)/gi,"$1$2-$3$4").r(/([А-яёЁ]{2,}) (ка|кась)([\s,\.\?!]|$)/g,"$1-$2$3").r(/([^А-яёЁ]|^)(вс[ёе]|так)(?:[  ]?|-[  ]|[  ]-)(таки)([^А-яёЁ]|$)/gi,"$1$2-$3$4").r(/(ГОСТ(?:[  ]Р)?(?:[  ](?:ИСО|ISO))?)[  ]([\d\.]+)-([\d]+)/gi,"$1 $2–$3");B=B.r(/([IVXLCDM]{1,3})-([IVXLCDM]{1,3})[  ]?вв?\.?([\s\.,?!;\)])/g,"$1—$2 вв.$3").r(/([\d]{1,4})-([\d]{1,4})[  ]?гг?\.([\s\.,?!;\)])/g,"$1–$2 гг.$3").r(/([^\d]|^)([0-2][0-9]:[0-5][0-9])-([0-2][0-9]:[0-5][0-9])([^\d]|$)/g,"$1$2–$3$4");var G="(?:[ьяюе]|[её]м)";var n="(?:[ауе]|ом)";var M="(январ"+G+"|феврал"+G+"|март"+n+"|апрел"+G+"|ма(?:[йяюе]|ем)|ию[нл]"+G+"август"+n+"|сентябр"+G+"|ноябр"+G+"|октябр"+G+"|декабр"+G+")";B=B.r(d("([\\s]|^)([1-3]?[\\d])-([1-3]?[\\d])[  ]?"+M+"([^А-яёЁ]|$)","gi"),"$1$2–$3 $4$5").r(d("([^А-яёЁ]|^)"+M+"-"+M+"([^А-яёЁ]|&)","gi"),"$1$2—$3$4")}B=B.r(/(\d)--(\d)/g,"$1–$2").r(/([^-]|\s|^)--([^-]|$|\n)/g,"$1—$2").r(/([^-\d]|^)(\d+)-(\d+)([^-\d]|$)/g,"$1$2−$3$4").r(/([^a-z][a-z]|[Α-Ωα-ω+=*\/])-(\d)/g,"$1−$2")}if(N.chars){B=B.r(/([^\.])\.{2,4}/g,"$1...").r(/(\?!|!\?)\.{3}/g,"?!.").r(/\?\.{3}/g,"?..").r(/!\.{3}/g,"!..").r(/(!+)(\?+)/g,"$2$1").r(/(\d+?)[xх](\d+?)/g,"$1×$2").r(/(\d+?)([  ])[xх]([  ])(\d+?)/g,"$1×$4").r(/([0-9a-zA-ZΑ-Ωα-ωА-яёЁ])\^([0-9]+)/g,function(w,i,S){var q="0123456789",R="⁰¹²³⁴⁵⁶⁷⁸⁹";var Q=S;for(var P=0;P<10;++P){Q=Q.r(d(q.charAt(P),"g"),R.charAt(P))}return i+Q}).r(/!=/g,"≠").r(/\+\/[\-−]/g,"±").r(/~=/g,"≈").r(/<=/g,"≤").r(/>=/g,"≥").r(/<->/g,"↔").r(/<-([^-]|&)/g,"←$1").r(/([^-]|^)->/g,"$1→").r(/(!+)(\?+)/g,"$2$1").r(/\?{3,}/g,"???").r(/!{3,}/g,"!!!");var v="([^0-9A-Za-zА-яёЁ/]|^)",u="([^0-9A-Za-zА-яёЁ/]|$)";B=B.r(d(v+"1/2"+u,"g"),"$1½$2").r(d(v+"1/4"+u,"g"),"$1¼$2").r(d(v+"2/4"+u,"g"),"$1½$2").r(d(v+"3/4"+u,"g"),"$1¾$2").r(d(v+"1/3"+u,"g"),"$1⅓$2").r(d(v+"2/3"+u,"g"),"$1⅔$2").r(d(v+"1/5"+u,"g"),"$1⅕$2").r(d(v+"2/5"+u,"g"),"$1⅖$2").r(d(v+"3/5"+u,"g"),"$1⅗$2").r(d(v+"4/5"+u,"g"),"$1⅘$2").r(d(v+"1/6"+u,"g"),"$1⅙$2").r(d(v+"2/6"+u,"g"),"$1⅓$2").r(d(v+"3/6"+u,"g"),"$1½$2").r(d(v+"4/6"+u,"g"),"$1⅔$2").r(d(v+"5/6"+u,"g"),"$1⅚$2").r(d(v+"1/8"+u,"g"),"$1⅛$2").r(d(v+"2/8"+u,"g"),"$1¼$2").r(d(v+"3/8"+u,"g"),"$1⅜$2").r(d(v+"4/8"+u,"g"),"$1½$2").r(d(v+"5/8"+u,"g"),"$1⅝$2").r(d(v+"6/8"+u,"g"),"$1¾$2").r(d(v+"7/8"+u,"g"),"$1⅞$2").r(/,+/g,",").r(/:+/g,":").r(/;+/g,";").r(/([a-zA-ZА-яёЁ0-9]) (а|но)([\s$,]|\.\.\.)/g,"$1, $2$3").r(/([a-zA-ZА-яёЁ0-9]) однако([\s$,\.!?:])/g,"$1, однако$2");B=B.r(/([^a-zА-яёЁ]|^)([a-zА-яёЁ]+)[  ](\2)([^a-zA-ZА-яёЁ]|$)/gi,"$1$2$4")}if(N.quotes){B=B.r(/(^|\n|\s|—|-|\()"/g,"$1«").r(/"($|\n|\s|—|-|\.|,|!|\?|:|;|\))/g,"»$1").r(/«\)/g,"»)").r(/«( ?)/g,"«").r(/( ?)»/g,"»").r(/>"/g,">«").r(/"</g,"»<").r(/«""/g,"«««").r(/«"/g,"««").r(/""»/g,"»»»").r(/"»/g,"»»").r(/("{2}|"»)/g,"»»").r(/$"/g,"«").r(/([A-Za-zа-яА-ЯёЁ])'/g,"$1’");B=B.r(/[a-zA-ZА-яёЁ]"-/g,"$1»-").r(/-"[a-zA-ZА-яёЁ]/g,"-«$1");B=B.r(/(^[^«»]*)"/g,"$1«").r(/"([^«»]*$)/g,"»$1").r(/«([^«»]*)"/g,"«$1»").r(/"([^«»]*)»/g,"«$1»");if(N.lang=="rus"&&N.quotesLevel>1){function z(q,l){var g="",P,w="";if(q!=0){g=B.substring(0,q)}if(l!=B.length-1){w=B.substring(l+1,B.length)}P=B.substring(q,l+1);for(var q=0;q<32;++q){P=P.r(/«([^«»]*)«([^»]*)»/g,"«$1„$2“");if(N.quotesLevel>2){P=P.r(/„([^„“]*)„([^“]*)“/g,"„$1‚$2‘")}}return g+P+w}var k=0;for(var J=0;J<B.length;++J){if(B.charAt(J)=="«"){++k;for(var H=J+1;H<B.length;++H){if(B.charAt(H)=="«"){++k}if(B.charAt(H)=="»"){--k;if(k<=0){B=z(J,H);J=H;break}}}k=0}}}else{B=B.r(/'([A-Za-zа-яА-ЯёЁ])/g,"‘$1")}}if(A){if(N.chars){B=B.r(/<(?!\/?[A-Za-z][^\n$<>]*>|!--)/g,"&lt;").r(/(<\/?[A-Za-z][^\n$<>]*|--)?>/g,function(i,g){return g?i:"&gt;"})}if(N.tabs){B=B.r(/(\n)(?!<p>)([^\n]*)(?!<\/p>)(\n)/g,"$1<p>$2</p>$3").r(/(\n)(?!<p>)([^\n]*)(?!<\/p>)(\n)/g,"$1<p>$2</p>$3").r(/ +<\/p>(\n)/g,"</p>$1");if(y){B=B.r(/(^)(?!<p>)([^\n]*)(?!<\/p>)(\n)/g,"$1<p>$2</p>$3");if(t){B=B.r(/(^)(?!<p>)([^\n]*)(?!<\/p>)($)/g,"$1<p>$2</p>$3")}}if(t){B=B.r(/(\n)(?!<p>)([^\n]*)(?!<\/p>)($)/g,"$1<p>$2</p>$3").r(/ +<\/p>(\n|$)/g,"</p>$1")}B=B.r(/<p>(UNTYPO[\d]+)<\/p>/g,"$1");B=B.r(/<p><\/p>/g,"").r(/<p>(UNTYPO[\d]+S)<\/p>/g,"$1");B=B.r(/<p>(.*?<\/?)([uo]l|li)(>.*?)<\/p>/g,"$1$2$3")}if(N.h1){var I=N.tabs?"<p>":"";var h=N.tabs?"</p>":"";B=B.r(d("(\n|^)"+I+'([А-яёЁa-zA-Z0-9"«“][^\n]{1,50}[А-яёЁa-zA-Z0-9"»”)])'+h+"(\n|$)","g"),"$1<h1>$2</h1>$3").r(/<h1>([^а-яА-ЯёЁa-zA-Z§]+?)<\/h1>/g,I+"$1"+h).r(d("(\n|^)"+I+"(Глава|Chapter|Section|§)([  ]?[IVXLСDМ0-9][^\n]{0,43})"+h+"(\n|$)","g"),"$1<h1>$2$3</h1>$4").r(d("(\n|^)"+I+"(Эпилог|Пролог|Epilogue|Prologue)(.?)"+h+"(\n|$)","g"),"$1<h1>$2$3</h1>$4").r(/<h1>(UNTYPO[\d]+S)<\/h1>/g,"$1")}if(N.nbsp){B=B.r(/([А-яёЁa-zA-Z0-9]+)((?:-[А-яёЁa-zA-Z0-9]+)+)/g,"<nbsp>$1$2</nbsp>")}}if(N.lang=="eng"){B=B.r(/«/g,"“").r(/»/g,"”")}if(!N.nbsp){B=B.r(/ /g," ")}if(N.br){B=B.r(/\n/g,"<br />")}B=B.r(/ (\))/g,"$1");if(A){for(var J=0;J<m.length;++J){B=B.r(d(m[J],"g"),"&"+L[J]+";")}}if(N.nbsptabs){B=B.r(/ /g,"&nbsp;")}B=this.unprotect(N,B);return B}};function a(g,i,h){if(g.addEventListener){g.addEventListener(i,h,false)}else{aelementattachEvent("on"+i,h)}}function e(g,i,h){if(g.removeEventListener){g.removeEventListener(b,c,false)}else{g.detachEvent("on"+i,h)}}window.JsTypograph=function(g){this.config=f.fixConfig(g);this.textAreas=[];this.setConfig=function(h){this.config=Object.assign(this.config,h)};this.typographyText=function(i,h,j){h==null?h=true:null;j==null?j=true:null;return f.typographyText(this.config,i,h,j)};this.typographySelection=function(h){return f.typographySelection(this.config,textArea)};this.typography=function(){for(var h=0;h<this.textAreas.length;++h){this.typographySelection(this.textAreas[h])}};this.addTextArea=function(h){this.textAreas.push(h)};this.removeTextArea=function(h){var i=textAreas.indexOf(h);if(i>-1){textAreas.splice(i,1)}};this.addButton=function(h){a(h,"click",this.typography)};this.removeButton=function(h){e(h,"click",this.typography)}};window.JsTypographCore=f})();